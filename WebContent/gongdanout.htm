<!DOCTYPE html>
<html  class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms no-csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" style=""><!--<![endif]--><!-- =========================================
    head
    ========================================== --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


        <!-- =========================================
        Basic
        ========================================== -->
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>智能周专柜</title>
        <!-- =========================================
        Mobile Configurations
        ========================================== -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=no">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="GOOGLEBOT" content="index follow">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <!-- =========================================
        CSS
        ========================================== -->
        
        <link rel="stylesheet" media="screen" href="css/bootstrap.min.css">
		<link rel="stylesheet" media="screen" href="css/font-awesome.min.css">
        <link rel="stylesheet" media="screen" href="css/style.css">
		<link rel="stylesheet" type="text/css" href="css/demo.css" />
        <link rel="stylesheet" type="text/css" href="css/style3.css" />
		<link rel="stylesheet" href="css/buttons.css">
		<link rel="stylesheet" href="css/ui-dialog.css">

        <!-- =========================================
        Head Libs
        ========================================== -->
                <script type="text/javascript" src="css/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="css/modernizr.custom.js"></script>
        <script src="dist/dialog-min.js"></script>
		<style type="text/css">
       .in1{
display: block;
width: 100%;
height: 70px;
padding: 12px 12px;
font-size: 14px;
margin-left:13px  ! important;
line-height: 1.42857143;
color: #555;
background-color: #fff;
background-image: none;
border: 1px solid #ccc;
border-radius: 4px;
-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
-webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
-o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
	   }
	   .aaa h1{
	   font-size:45px;
	   }
	   .mar{
	   margin-top:30px;
	   }
	   .juzhong{
	  text-align:center;
	  margin:20px auto;
	   }
	   .w80{
	   margin:30px auto;
	   width:80%;
	   }
	   .maxhei{
	   max-height: 280px;
	   overflow:scroll;
	   }
        </style>

    </head><!-- /head -->




    <!-- =========================================
    body
    ========================================== -->
    <body>



        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->





        <!-- =========================================
        Menu
        ========================================== -->
        <!-- nav-wrapper -->
        <div id="nav-wrapper">
            <!-- navbar -->
            <div class="navbar">
                <!-- container -->
                <div class="container">
                    <!-- row -->
                    <div class="row">

                        <!-- col-md-12 -->
                        <div class="col-md-12">

                            <!-- navbar-header -->
                            <div class="navbar-header">

                                <!-- Mobile Menu -->
                                <button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
                                    <i class="fa fa-bars"></i>
                                </button><!-- / mobile Menu -->

                                <!-- logo -->
                                <a href="#" class="navbar-brand scrollto" title="Horrus">
                                    <img src="./css/logo2.png" alt="logo">
                                </a><!-- /logo -->

                            </div><!-- /navbar-header -->

                            <!-- navbar-collapse -->
                            <div class="navbar-collapse collapse">

                                <!-- nav -->
                                <ul class="nav navbar-nav navbar-right">

                                    <!-- Home -->
                                    <li>
                                        <a href="#" title="Home" class="scrollto">
                                           首页
                                        </a>
                                    </li><!-- /Home -->

                                    <!-- Services -->
                                    <li>
                                        <a href="#" title="Our Services" class="scrollto">
                                           帮助                                       </a>
                                    </li><!-- /Services -->

                                    <!-- Portfolio -->
                                    <li>
                                        <a href="#" title="Portfolio" class="scrollto">
                                           关于
                                        </a>
                                    </li><!-- /Portfolio -->

                                </ul><!-- /nav -->

                            </div><!-- /navbar-collapse -->

                        </div><!-- /col-md-12 -->

                    </div><!-- /row -->
                </div><!-- /container -->
            </div><!-- /navbar -->
        </div><!-- /nav-wrapper -->

    <section id="contact-section">
           
           <div id="div2">
		   <div  class="panel panel-default w80">
		   <div class="panel-heading">工单出库操作</div>
		<div id="dateMessage" class="maxhei">   
        <table id="tab1" class="table">   
            <tr><td>位置号</td><td>行号</td><td>列号</td><td>型号</td><td>输入条码</td></tr>   
        </table>   
        </div>   
            

         
		</div>
		<div class="juzhong">
		<button class="button button-royal button-raised  juzhong" id="button1">确认出库</button>
		</div>
		</div>
        </section>

		<div >  
            


		</div>
        
		<footer class="footer">
		<h1>Footer</h1>
		</footer>






        <!-- =========================================
        java script
        ========================================== -->

        <script type="text/javascript" src="css/bootstrap.min.js"></script>
        <script type="text/javascript" src="css/jquery.easing.1.3.js"></script>
        <script type="text/javascript" src="css/uikit.js"></script>
        <script type="text/javascript" src="css/jquery.lwtCountdown-1.0.js"></script>
        <script type="text/javascript" src="css/jquery.scrollto.js"></script>
        <script type="text/javascript" src="css/jquery.parallax-1.1.3.js"></script>
        <script type="text/javascript" src="css/owl.carousel.min.js"></script>
        <script type="text/javascript" src="css/jquery.mousewheel-3.0.6.pack.js"></script>
        <script type="text/javascript" src="css/jquery.fancybox.js"></script>
        <script type="text/javascript" src="css/jquery.fancybox-media.js"></script>
        <script type="text/javascript" src="css/jquery.fitvids.js"></script>
        <script type="text/javascript" src="css/jquery.cbpQTRotator.min.js"></script>
		<script >   

	
      $(document).ready(function(){
		  var arrid=new Array();
		  var arrcode=new Array();
		  var a1=2;
		  var a3=3;
    $.ajax( {    
    url:'ChukugdServlet',
    data:{name:a1,password:a3},
    type:'post',    
    cache:false,    
    dataType:'json',
    success: function (msg) {
        var str = "";
        var dlall=document.getElementsByName('aaa');
        for (i in msg) {
            str += "<tr><td>" + msg[i].id + "</td><td>" + msg[i].row + "</td><td>" + msg[i].col + "</td><td>" + msg[i].model + "</td><td><input name=aaa style='width:200px'>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<button onclick='del(this)' class='button button-pill button-primary button-small'>重新扫描</button></td></tr>";
			arrid[i]=msg[i].id;
			arrcode[i]=msg[i].metercode;
        }
        $("tbody").append(str);
        var dlall=document.getElementsByName('aaa');
        for(i=0;i<dlall.length;i++){
        	dlall[i].id='inp'+i;
        }
        var d = dialog({
    		title: '消息',
    		content: '请打开柜门，按照页面提示位置及其亮灯状态取表',
    		 okValue: '确定',
    		 ok: function () {},
    		 cancel: false,
    	});
        $.ajax({    
            url:'OpendoorServlet',
            data:{name:a1,password:a3},
            type:'post',    
            cache:false,    
            dataType:'json',
        });
    	d.showModal();
    	SpeakText();
    },

    error: function(aa) {
    	var d = dialog({
    		lock:true,
    		title: '警告消息',
    		content: '请求出库仪表数量大于库存仪表数量，请点击确定返回上一级重新选择仪表数量',
    		 okValue: '确定',
    		    ok: function () {
    		    	location.reload(true);
    		    },
    		    cancel: false,
    	});
    	d.showModal();
    },
    complete: function(XMLHttpRequest, textStatus) {
        this; // 调用本次AJAX请求时传递的options参数
    }
    });


	$("#button1").click(function(){
		  var scode=arrcode.join(",");
		  var sid=arrid.join(",");
    $.ajax( {    
    url:'GongoutServlet',
    data:{name:scode,password:sid},
    type:'post',    
    cache:false,    
    dataType:'json',
    success: function (a) {
    	SpeakTextses();
        alert(a);
        window.location.href="n3.htm";
    },

    error: function(bb) {
    	var d = dialog({
    		lock:true,
    		title: '消息',
    		content: '成功，系统将回到首页',
    		 okValue: '确定',
    		    ok: function () {
    		    	 window.location.href="n3.htm";
    		    },
    		    cancel: false,
    	});
    	d.showModal();
    	SpeakTextfal();
    },
    complete: function(XMLHttpRequest, textStatus) {
        this; // 调用本次AJAX请求时传递的options参数
    }
    });
});




});
</script>   
<script type="text/javascript">
var keystring = "";//记录按键的字符串
var a=1;

//var ab = document.getElementById("tab1").rows.length;
function keypress(e)
　　{
　　var currKey=0,CapsLock=0,e=e||event;
　　currKey=e.keyCode||e.which||e.charCode;
　　CapsLock=currKey>=65&&currKey<=90;
    var table =document.getElementById("tab1");
    var rows = table.rows.length;
　　switch(currKey)
　　{
　　　　//屏蔽了退格、制表、回车、空格、方向键、删除键
　　　　case 8: case 9:case 32:case 37:case 38:case 39:case 40:case 46:keyName = "";break;
　　　　default:keyName = String.fromCharCode(currKey); break;
　　}
　　keystring += keyName;
   if(currKey==13)
	{
		   for ( var i = 0; i < rows+2; i++) //循环到arr数组的长度减一，最后一个就不用循环了 
		{
          if(document.getElementById('inp'+i).value==""){
          document.getElementById('inp'+i).value=keystring;
		  keystring="";
           keyName="";
		 break;
          }
		}
	}

}
function keyup(e)
{
　　document.getElementById("content").innerHTML=keystring;
    document.getElementById("aa1").value=keystring;
	currKey=e.keyCode||e.which||e.charCode;
	//if(currKey==13){
      //     keystring="";
        //   keyName="";
		//{
}
document.onkeypress=keypress;
document.onkeyup =keyup;

</script>
<script >   
		function del(obj)   
		  {   
		     obj.parentNode.firstChild.value="";   
		  }
		</script >
		<SCRIPT LANGUAGE="JavaScript">
            var VoiceObj = new ActiveXObject("Sapi.SpVoice"); //创建一个朗读人
            VoiceObj.Rate=-4;
            //VoiceObj.Speak("请分别选择两种表计数量", 1);
            function SpeakText()
            {
            	VoiceObj.Speak("请打开柜门，按顺序取出亮灯位置的表计", 1);
            	
            }
            function SpeakTextses()
            {
            	VoiceObj.Speak("出库成功，请关闭柜门", 1);
            }
            function SpeakTextfal()
            {
            	VoiceObj.Speak("出库失败，表位异常，请放回表计", 1);
            }
        </SCRIPT>
</body>
</html>